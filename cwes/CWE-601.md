# Pattern: CWE-601 Open Redirect (Generic)

## What to look for
- Sources: attacker‑controlled URL/path/query fragments used to build a redirect Location header or HTTP 3xx response.
- Sinks: code that writes `Location:` or constructs 3xx responses.

## Red flags
- Redirects built from unvalidated user input, even after URL decoding.
- Lack of allowlist for hosts/paths, no scheme/domain checks, no relative‑only enforcement.

## High‑level procedure (IDA Pro MCP)
1) Find strings: `"Location:"`, `"HTTP/1.1 30"`, `"redirect"`.
2) Xref and decompile redirect builders; identify where the Location value comes from.
3) Walk back to dispatcher/handlers to see if user input influences the Location.

## Desired fix shape
- Enforce relative redirects or strict allowlist of domains/paths.
- Normalize/validate the target before emitting Location.

## Dynamic spot‑checks
- Try `?next=http://attacker/` or path parameters that are reflected into Location.

